<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Animal Classifier</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body 
    {
      background: linear-gradient(to bottom right, #f0f4ff, #ffffff);
    }

    .transition-width 
    {
      transition: width 0.6s ease-out;
    }
  </style>
</head>
<body class="min-h-screen font-sans text-gray-800">

  <!-- Classifier UI -->
  <section class="min-h-screen flex items-center justify-center py-20">
    <div class="bg-white shadow-2xl rounded-2xl p-10 max-w-lg w-full text-center space-y-6">
      <h1 class="text-3xl font-bold">üêæ Animal Image Classifier</h1>
      <p class="text-gray-500">Upload a photo of a cat or dog and the model will classify which it thinks it is.</p>

      <img id="preview" src="" class="w-48 h-48 object-cover mx-auto rounded-lg hidden" />

      <input type="file" id="imageInput" accept="image/*" class="block w-full border border-gray-300 rounded-lg p-2" />
      <button id="predictBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50" disabled>
        Predict
      </button>

      <div class="flex items-center justify-center space-x-2 min-h-[24px]">
        <div id="resultText" class="text-lg font-medium text-gray-700"></div>
        <svg id="spinner" class="animate-spin h-5 w-5 text-blue-600 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
        </svg>
      </div>

      <div id="progressContainer" class="w-full bg-gray-200 rounded-full h-4 hidden">
        <div id="confidenceBar" class="bg-green-500 h-4 rounded-full transition-width" style="width:0%"></div>
      </div>

      <p class="text-gray-400 text-sm">‚Üì Scroll down to see how it‚Äôs made</p>
    </div>
  </section>

  <!-- How It's Made Section -->
  <section class="py-24 bg-gray-100 px-6">
    <div class="max-w-4xl mx-auto text-gray-800">
      <h2 class="text-4xl font-bold text-center mb-10">How It‚Äôs Made</h2>

      <p class="mb-6">
        This image classification web application was developed entirely from scratch using <strong>Python, TensorFlow, Flask,</strong> and <strong>vanilla frontend</strong>. It allows users to upload an image of a cat or dog and returns a prediction based on a custom trained convolutional neural network (CNN).
      </p>

      <h3 class="text-2xl font-semibold mb-2">Model Info</h3>
      <p class="mb-6">
        This model was trained on a dataset of ~19,000 labeled images of cats and dogs. The model was implemented using tf.keras.Sequential, allowing layers to be stacked sequentially so data flows straight through from the input image to the final prediction. The network was built entirely from scratch without pretrained weights or external model libraries.
      </p>
      <p class="mb-6">
        Architecture: three convolutional blocks (<code>Conv2D</code> + <code>MaxPooling2D</code>) followed by a <code>Flatten</code> layer and dense layers with <code>softmax</code> activation for binary classification.
      </p>

      <h3 class="text-2xl font-semibold mb-2">Problems I Ran Into</h3>
      <p class="mb-6">
        Initial accuracy was poor due to overfitting. I introduced data augmentation (<code>RandomFlip</code>, <code>RandomRotation</code>, <code>RandomZoom</code>) applied only to the training set. I also added an <code>EarlyStopping</code> callback that monitors validation loss and restores the best weights when no improvement is seen for 10 epochs.
      </p>

      <h3 class="text-2xl font-semibold mb-2">GPU Optimization</h3>
      <p class="mb-6">
        TensorFlow was configured with <code>tf.config.experimental.set_memory_growth()</code> so GPU memory is allocated dynamically, preventing it from pre‚Äëallocating all available VRAM and allowing other GPU processes to run concurrently.
      </p>

      <h3 class="text-2xl font-semibold mb-2">Backend</h3>
      <p class="mb-6">
        After training, the model was saved in <code>.h5</code> format and loaded by a Flask app. The backend exposes a <code>GET</code> route for this page and a <code>POST</code> route (<code>/predict</code>) that accepts an image, preprocesses it with Pillow, and returns JSON containing the predicted label and confidence.
      </p>

      <h3 class="text-2xl font-semibold mb-2">Frontend</h3>
      <p class="mb-6">
        The interface is plain HTML styled with TailwindCSS. JavaScript handles image preview, disables/enables the Predict button, shows a spinner during inference, and animates the confidence bar once a result is received.
      </p>
    </div>
  </section>

  <script>
    const fileInput = document.getElementById('imageInput');
    const preview = document.getElementById('preview');
    const predictBtn = document.getElementById('predictBtn');
    const resultText = document.getElementById('resultText');
    const spinner = document.getElementById('spinner');
    const progressContainer = document.getElementById('progressContainer');
    const confidenceBar = document.getElementById('confidenceBar');

    fileInput.onchange = () => {
      const file = fileInput.files[0];
      if (!file) {
        predictBtn.disabled = true;
        preview.classList.add('hidden');
        return;
      }
      predictBtn.disabled = false;

      const reader = new FileReader();
      reader.onload = e => {
        preview.src = e.target.result;
        preview.classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    };

    predictBtn.onclick = () => {
      if (!fileInput.files[0]) {
        resultText.textContent = '‚ùå Please select an image first.';
        return;
      }

      resultText.textContent = 'üîé Predicting...';
      spinner.classList.remove('hidden');
      progressContainer.classList.add('hidden');
      confidenceBar.style.width = '0%';

      const formData = new FormData();
      formData.append('image', fileInput.files[0]);

      fetch('/predict', { method: 'POST', body: formData })
        .then(res => res.json())
        .then(data => {
          spinner.classList.add('hidden');

          if (data.error) {
            resultText.textContent = '‚ö†Ô∏è Error: ' + data.error;
          } else {
            const pct = (data.confidence * 100).toFixed(1);
            resultText.textContent = `‚úÖ It's a ${data.label} with ${pct}% confidence`;
            progressContainer.classList.remove('hidden');
            requestAnimationFrame(() => {
              confidenceBar.style.width = pct + '%';
            });
          }
        })
        .catch(() => {
          spinner.classList.add('hidden');
          resultText.textContent = '‚ùå Server error.';
        });
    };
  </script>
</body>
</html>
